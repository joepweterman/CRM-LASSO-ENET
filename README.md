# CRM-LASSO-ENET
Alternative versions of the cellwise robust M regression, with simulation study included. It contains the original files of the R package crmReg with some extra R files used in for the alternative versions. 

# Description
The repository contains the R package crmReg, which includes the cellwise robust M (CRM) regression algorithm implementations and the Sparse Direction of Maximal Outlyingness (SPADIMO) algorithm. The repository also includes two new CRM functions, denoted by crm_lasso.R and crm_enet.R, in which  two alternative versions of a SPADIMO algorithm are used, and thus also two new SPADIMO files which are denoted by spadimo_lasso.R and spadimo_enet.R. In the new SPADIMO functions the regression used for the initial estimation of the vector regression was replaced by a Least Absolute Shrinkage and Selection Operator (LASSO) regression and an Elastic Net regression. This meant that the spadimo.exs function in the spadimo.R file needed to be replaced by new functions that used the LASSO and Elastic Net regression instead of the SNIPLS regression. The rest of the files are similar to the files in the crmReg R package, except that the CRM and SPADIMO functions are replaced by the new CRM and SPADIMO functions. Additionally, the repository includes the predict functions for the two new fitted CRM regression models, which are saved in predict.crm_lasso.R and predict.crm_enet.R. These predict functions work very similarly to the original predict function of CRM, however, the CRM used in the predict function needed to be updated. 

The R scripts for the simulations studies and the real-world application as used in our research are also included. The first R script, CRM_simulations_part1.R, includes the simulation study with the fixed parameters. It then calculates the average Mean Squared Error of Prediction (MSEP), Mean Absolute Error (MAE), and Rooted Mean Squared Error of Imputation (RMSEI) over a hundred simulations for the CRM, CRM-LASSO and CRM-ElasticNet. The second R script, CRM_simulations_part2.R, includes the simulation study where the level of contamination is varied. So the MSEP, MAE and RMSEI are calculated under a varying parameter k, and are then reported for the CRM, CRM-LASSO and CRM-ElasticNet. The third R script, CRM_simulations_part3.R, includes the simulation study in which the percentage of casewise contamination is varied. So, the MSEP, MAE and RMSEI are again calculated for different percentages of casewise contamination and are then reported for the CRM, CRM-LASSO and CRM-ElasticNet. The last R script, CRM_simulations_part4.R, includes the simulation study in which the percentage of cellwise contamination is varied. So, again, the MSEP, MAE and RMSEI are calculated for different percentages of cellwise contamination and are then reported for the CRM, CRM-LASSO and CRM-ElasticNet. The repository also includes an R script in which a 10-fold cross-validation is performed, with as data the Swiss nutrients data. 

# References 
This code is adapted from Filzmoser et al. (2020)

https://github.com/SebastiaanHoppner/CRM

Filzmoser, P., H Ìˆoppner, S., Otner, I., Serneels, S. & Verdonck, T. (2020). Cellwise robust m
regression. Computional Statistics Data Analysis, 147
